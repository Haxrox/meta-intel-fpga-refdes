#@TYPE: Machine
#@NAME: Intel SoCFPGA Stratix10
#@DESCRIPTION: Machine configuration for the Stratix 10 SoCFPGA

IMAGE_TYPE:stratix10 ?= "gsrd"

UBOOT_CONFIG:stratix10 ?= "stratix10-socdk-atf stratix10-socdk-qspi-atf"

KERNEL_DEVICETREE:stratix10 ?= " \
		altera/socfpga_stratix10_socdk.dtb \
		${@bb.utils.contains("IMAGE_TYPE", "gsrd", "altera/socfpga_stratix10_socdk_nand.dtb", "", d)} \
		${@bb.utils.contains("IMAGE_TYPE", "gsrd", "altera/fpga_static_region.dtb", "", d)} \
		${@bb.utils.contains("IMAGE_TYPE", "gsrd", "altera/persona0.dtb", "", d)} \
		${@bb.utils.contains("IMAGE_TYPE", "gsrd", "altera/persona1.dtb", "", d)} \
		${@bb.utils.contains("IMAGE_TYPE", "pr", "altera/fpga_static_region.dtb", "", d)} \
		${@bb.utils.contains("IMAGE_TYPE", "pr", "altera/persona0.dtb", "", d)} \
		${@bb.utils.contains("IMAGE_TYPE", "pr", "altera/persona1.dtb", "", d)} \
		"

MACHINE_ESSENTIAL_EXTRA_RRECOMMENDS:stratix10 += " \
		kernel-modules \
		${@bb.utils.contains("IMAGE_TYPE", "gsrd", " kernel-devicetree", "", d)} \
		${@bb.utils.contains("IMAGE_TYPE", "gsrd", " hw-ref-design", "", d)} \
		${@bb.utils.contains("IMAGE_TYPE", "pr", " kernel-devicetree", "", d)} \
		${@bb.utils.contains("IMAGE_TYPE", "pr", " hw-ref-design", "", d)} \
		"

EXTRA_IMAGEDEPENDS:stratix10 += " \
		u-boot-socfpga-scr \
		${@bb.utils.contains("IMAGE_TYPE", "gsrd", "", "hw-ref-design", d)} \
		${@bb.utils.contains("IMAGE_TYPE", "pr", "", "hw-ref-design", d)} \
		"

IMAGE_BOOT_FILES:stratix10 = " \
		${@bb.utils.contains("IMAGE_TYPE", "gsrd", "", "${MACHINE}_${IMAGE_TYPE}_ghrd/ghrd.core.rbf;ghrd.core.rbf", d)} \
		${@bb.utils.contains("IMAGE_TYPE", "gsrd", "boot.scr.uimg", "u-boot.scr", d)} \
		u-boot.itb \
		kernel.itb \
		${@bb.utils.contains("IMAGE_TYPE", "gsrd", "", "socfpga_stratix10_socdk.dtb", d)} \
		"
